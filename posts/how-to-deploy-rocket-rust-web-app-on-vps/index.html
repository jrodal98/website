<!doctype html><html lang=en-us prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb#"><head lang=en-us><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><meta name=HandheldFriendly content="True"><meta name=MobileOptimized content="320"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=color-scheme content="dark light"><meta name=description content="How to Deploy a Rocket Rust Web Application on VPS"><meta name=author content><meta name=keywords content="rocket,rust,vps,nginx,linux,ssh,github-actions,web-dev"><title>How to Deploy a Rocket Rust Web Application on VPS | Jacob Rodal</title><link rel=canonical href=/posts/how-to-deploy-rocket-rust-web-app-on-vps/><meta property="og:type" content="article"><meta property="og:description" content="How to Deploy a Rocket Rust Web Application on VPS"><meta property="og:title" content="How to Deploy a Rocket Rust Web Application on VPS"><meta property="og:site_name" content="Jacob Rodal"><meta property="og:image:type" content="image/jpeg"><meta property="og:url" content="/posts/how-to-deploy-rocket-rust-web-app-on-vps/"><meta property="og:locale" content="en-us"><meta property="article:published_time" content="2020-08-15"><meta property="article:modified_time" content="2020-08-15"><meta property="article:tag" content="rocket"><meta property="article:tag" content="rust"><meta property="article:tag" content="vps"><meta property="article:tag" content="nginx"><meta property="article:tag" content="linux"><meta name=twitter:card content="summary"><meta name=twitter:title content="How to Deploy a Rocket Rust Web Application on VPS | Jacob Rodal"><meta name=twitter:description content="How to Deploy a Rocket Rust Web Application on VPS"><meta name=twitter:domain content="/posts/how-to-deploy-rocket-rust-web-app-on-vps/"><link rel=icon href=/favicon.ico><link rel=stylesheet href=//cdn.jsdelivr.net/npm/modern-normalize@1.0.0/modern-normalize.min.css><link rel=stylesheet href=/style.min.545776622efaf5969d6e6e7c36fa184365f4d7d8521840035c54446528e8d0d2.css integrity="sha256-VFd2Yi769Zadbm58NvoYQ2X019hSGEADXFREZSjo0NI=" rel="preload stylesheet" as=style></head><body><script>const currentTheme=window.localStorage.getItem("theme");currentTheme==="dark"?document.body.classList.toggle("theme-dark"):currentTheme=="light"&&document.body.classList.toggle("theme-light")</script><header id=header><div class=row><div class="container has-padding nav"><button id=navbar-toggler class=navbar-button aria-hidden=true><svg xmlns="http://www.w3.org/2000/svg" class="ionicon" viewBox="0 0 512 512"><path d="M64 384h384v-42.67H64zm0-106.67h384v-42.66H64zM64 128v42.67h384V128z"/></svg></button><div class=navbar-brand><a class="logo navbar-button" href=/ title="Jacob Rodal"><span>Jacob Rodal</span></a></div><nav class=navbar role=navigation><ul><li class="nav-bar-item active"><a class="nav-link navbar-button" href=/posts/ title=Posts><span>posts</span></a></li><li class=nav-bar-item><a class="nav-link navbar-button" href=/tags/ title=Tags><span>tags</span></a></li><li class=nav-bar-item><a class="nav-link navbar-button" href=/archives/ title=Archives><span>archives</span></a></li><li class=nav-bar-item><a class="nav-link navbar-button" href=/about/ title=About><span>about</span></a></li></ul></nav><div class=theme-selector><button class="button is-text" id=theme-selector-button title="toggle theme">
<span class="label icon"><svg xmlns="http://www.w3.org/2000/svg" class="ionicon" viewBox="0 0 512 512"><path d="M256 32C132.29 32 32 132.29 32 256s100.29 224 224 224 224-100.29 224-224S379.71 32 256 32zM128.72 383.28A180 180 0 01256 76v360a178.82 178.82.0 01-127.28-52.72z"/></svg></span></button></div></div><div class="container has-padding"><div class=breadcrumb><ol class=breadcrumb-nav><li><a href=/>Home</a></li><li><a href=/posts/>Posts</a></li><li class=active><a href=/posts/how-to-deploy-rocket-rust-web-app-on-vps/>How to Deploy a Rocket Rust Web Application on VPS</a></li></ol></div></div></div></header><main id=main><div class="container has-padding"><div class="article-card post single"><h1 class=title>How to Deploy a Rocket Rust Web Application on VPS</h1><div class=post-info><span><svg xmlns="http://www.w3.org/2000/svg" class="ionicon" viewBox="0 0 512 512"><path d="M32 456a24 24 0 0024 24h4e2a24 24 0 0024-24V176H32zm320-244a4 4 0 014-4h40a4 4 0 014 4v40a4 4 0 01-4 4h-40a4 4 0 01-4-4zm0 80a4 4 0 014-4h40a4 4 0 014 4v40a4 4 0 01-4 4h-40a4 4 0 01-4-4zm-80-80a4 4 0 014-4h40a4 4 0 014 4v40a4 4 0 01-4 4h-40a4 4 0 01-4-4zm0 80a4 4 0 014-4h40a4 4 0 014 4v40a4 4 0 01-4 4h-40a4 4 0 01-4-4zm0 80a4 4 0 014-4h40a4 4 0 014 4v40a4 4 0 01-4 4h-40a4 4 0 01-4-4zm-80-80a4 4 0 014-4h40a4 4 0 014 4v40a4 4 0 01-4 4h-40a4 4 0 01-4-4zm0 80a4 4 0 014-4h40a4 4 0 014 4v40a4 4 0 01-4 4h-40a4 4 0 01-4-4zm-80-80a4 4 0 014-4h40a4 4 0 014 4v40a4 4 0 01-4 4h-40a4 4 0 01-4-4zm0 80a4 4 0 014-4h40a4 4 0 014 4v40a4 4 0 01-4 4h-40a4 4 0 01-4-4zM456 64h-55.92V32h-48v32H159.92V32h-48v32H56A23.8 23.8.0 0032 87.77V144h448V87.77A23.8 23.8.0 00456 64z"/></svg><time datetime=2020-08-15T00:00:00Z class=date>August 15, 2020</time></span>
<span><svg xmlns="http://www.w3.org/2000/svg" class="ionicon" viewBox="0 0 512 512"><path d="M256 48C141.13 48 48 141.13 48 256c0 114.69 93.32 208 208 208 114.86.0 208-93.14 208-208 0-114.69-93.31-208-208-208zm108 240H244a4 4 0 01-4-4V116a4 4 0 014-4h24a4 4 0 014 4v140h92a4 4 0 014 4v24a4 4 0 01-4 4z"/></svg>7 mins to read</span>
<span><svg xmlns="http://www.w3.org/2000/svg" class="ionicon" viewBox="0 0 512 512"><path d="M456 48H56A24 24 0 0032 72v288a24 24 0 0024 24h72v80l117.74-80H456a24 24 0 0024-24V72a24 24 0 00-24-24zM160 248a32 32 0 1132-32 32 32 0 01-32 32zm96 0a32 32 0 1132-32 32 32 0 01-32 32zm96 0a32 32 0 1132-32 32 32 0 01-32 32zM456 80z"/></svg><a href=#comments>comment</a></span>
<span>post</span></div><article class="post-entry content"><p>Tutorial for deploying a web application using Rocket, Virmach VPS, nginx, letsencrypt, systemd, and Github Actions.</p><div><h2>Table Of Contents</h2><nav id=TableOfContents><ul><li><a href=#step-1-acquire-a-vps-and-a-domain>Step 1: Acquire a VPS and a Domain</a></li><li><a href=#step-2-domain-settings>Step 2: Domain Settings</a></li><li><a href=#step-3-download-software-on-vps>Step 3: Download Software on VPS</a></li><li><a href=#step-4-compile-your-application-and-create-a-systemd-service>Step 4: Compile your Application and Create a Systemd Service</a></li><li><a href=#step-5-setup-nginx-webserver>Step 5: Setup Nginx Webserver</a></li><li><a href=#step-6-cicd-with-github-actions>Step 6: CI/CD with Github actions</a><ul><li><a href=#rustyml>rust.yml</a></li><li><a href=#deployyml>deploy.yml</a></li></ul></li><li><a href=#optional-safer-and-easier-sshing-into-your-vps>Optional: Safer and Easier SSHing into your VPS</a></li></ul></nav></div><h2 id=step-1-acquire-a-vps-and-a-domain>Step 1: Acquire a VPS and a Domain</h2><p>First, you need to figure out where you want to deploy your application. I chose <a href=https://virmach.com/>virmach</a> because they offer a dirt cheap $1 linux vps. It gives you 256 MB of memory, 10 GB of disk space, and 500 GB monthly bandwidth, which is more than enough for my needs. I&rsquo;ve been running my application on the $1 vps for over a year now and have had no issues.</p><p>I bought my domain from <a href=https://www.namecheap.com/>namecheap</a> because I was able to get an xyz domain name for $1, but it doesn&rsquo;t matter where you get yours. You can get a free .tk domain name at <a href="http://www.dot.tk/en/index.html?lang=en">dot.tk</a>, if you don&rsquo;t care about the unorthodox extension.</p><h2 id=step-2-domain-settings>Step 2: Domain Settings</h2><p>Next, you&rsquo;ll need to point your domain to your server. You do this by creating an A record that points to the ip address allocated to your VPS. You should also create a CNAME record if you want to be able to prepend www to your domain name.</p><p>This will probably appear in the DNS settings for your domain at your domain registrar. For me, I went to namecheap and then went to &ldquo;advanced dns&rdquo; for my domain. I added the records like so:</p><div align=center <figure><img src=/img/posts/how-to-deploy-rocket-rust-web-application-on-vps/dns_records.png></figure></div><p>where <strong>IP Address</strong> is the static IP address of your VPS and <strong>Target</strong> is your domain name.</p><p>It might take awhile for your changes to propagate across the internet, so be patient.</p><h2 id=step-3-download-software-on-vps>Step 3: Download Software on VPS</h2><p>I&rsquo;m going to assume that you&rsquo;re running something based on debian for simplicity. Downloading and updating packages with other distros will be left as an exercise to the reader.</p><p>First, update the list of available packages and then upgrade to the latest versions:</p><div class=highlight><div style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>apt update &amp;&amp; apt upgrade
</span></span></code></pre></td></tr></table></div></div><p>Next, install some necessary packages:</p><div class=highlight><div style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>apt install curl git gcc nginx certbot python-certbot-nginx
</span></span></code></pre></td></tr></table></div></div><p>If you have issues downloading <code>python-certbox-nginx</code>, try running <code>apt install software-properties-common dirmngr --install-recommends</code> followed by <code>add-apt-repository ppa:certbot/certbot</code>. Then, try reinstalling <code>python-certbot-nginx</code>.</p><p>Lastly, install rust with the following command:</p><div class=highlight><div style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl --proto <span style=color:#ed9d13>&#39;=https&#39;</span> --tlsv1.2 -sSf https://sh.rustup.rs | sh
</span></span></code></pre></td></tr></table></div></div><p>You should run <code>source $HOME/.cargo/env</code> to prepare the rocket rust environment.</p><p>If you run into a &ldquo;RUSTUP_UNPACK_RAM must be larger than X&rdquo; error, try running <code>export RUSTUP_UNPACK_RAM=X</code> and trying the rust install again.</p><h2 id=step-4-compile-your-application-and-create-a-systemd-service>Step 4: Compile your Application and Create a Systemd Service</h2><p>Get your source code onto your machine. I&rsquo;m assuming you know how to do this if you&rsquo;re using rust. If git isn&rsquo;t an option, research rsync to copy files from your host machine to your vps. Soon, we&rsquo;ll be using Github actions to automate this entire process. But for now, let&rsquo;s make sure we can deploy manually.</p><p><code>cd</code> into your project directory (created with cargo) and compile your project</p><div class=highlight><div style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">1
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">2
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#24909d>cd</span> YOUR_PROJECT_DIR
</span></span><span style=display:flex><span>cargo build --release
</span></span></code></pre></td></tr></table></div></div><p>Next, create a systemd file named /etc/systemd/system/YOUR_DOMAIN.service:</p><div class=highlight><div style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 1
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 2
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 3
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 4
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 5
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 6
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 7
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 8
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 9
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">10
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">11
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">12
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">13
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">14
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">15
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-/etc/systemd/system/YOUR_DOMAIN.service data-lang=/etc/systemd/system/YOUR_DOMAIN.service><span style=display:flex><span><span style=color:#6ab825;font-weight:700>[Unit]</span>
</span></span><span style=display:flex><span><span style=color:#bbb>Description</span>=<span style=color:#ed9d13>Put a description here</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6ab825;font-weight:700>[Service]</span>
</span></span><span style=display:flex><span><span style=color:#bbb>User</span>=<span style=color:#ed9d13>root</span>
</span></span><span style=display:flex><span><span style=color:#bbb>Group</span>=<span style=color:#ed9d13>root</span>
</span></span><span style=display:flex><span><span style=color:#bbb>WorkingDirectory</span>=<span style=color:#ed9d13>/path/to/project/dir</span>
</span></span><span style=display:flex><span><span style=color:#bbb>Environment</span>=<span style=color:#ed9d13>&#34;ROCKET_ENV=prod&#34;</span>
</span></span><span style=display:flex><span><span style=color:#bbb>Environment</span>=<span style=color:#ed9d13>&#34;ROCKET_ADDRESS=127.0.0.1&#34;</span>
</span></span><span style=display:flex><span><span style=color:#bbb>Environment</span>=<span style=color:#ed9d13>&#34;ROCKET_PORT=8000&#34;</span>
</span></span><span style=display:flex><span><span style=color:#bbb>Environment</span>=<span style=color:#ed9d13>&#34;ROCKET_LOG=critical&#34;</span>
</span></span><span style=display:flex><span><span style=color:#bbb>ExecStart</span>=<span style=color:#ed9d13>/path/to/project/dir/target/release/YOUR_APPLICATION_NAME</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6ab825;font-weight:700>[Install]</span>
</span></span><span style=display:flex><span><span style=color:#bbb>WantedBy</span>=<span style=color:#ed9d13>multi-user.target</span>
</span></span></code></pre></td></tr></table></div></div><p>You might not want to use root as the user, depending on your vps. Research systemd and modify it as desired.</p><p>Start your service with <code>systemctl start YOUR_DOMAIN.service</code> and enable it to run on system startup with <code>systemctl enable YOUR_DOMAIN.service</code>. Your application should now be running - check with <code>systemctl status YOUR_DOMAIN.service</code></p><h2 id=step-5-setup-nginx-webserver>Step 5: Setup Nginx Webserver</h2><p>Put something like this in /etc/nginx/sites-available/YOUR_DOMAIN:</p><div class=highlight><div style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 1
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 2
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 3
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 4
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 5
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 6
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 7
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 8
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 9
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">10
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">11
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">12
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">13
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">14
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">15
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">16
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">17
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">18
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">19
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">20
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">21
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">22
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">23
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-nginx data-lang=nginx><span style=display:flex><span><span style=color:#6ab825;font-weight:700>server</span> {
</span></span><span style=display:flex><span>    <span style=color:#6ab825;font-weight:700>listen</span> <span style=color:#3677a9>80</span>;
</span></span><span style=display:flex><span>    <span style=color:#6ab825;font-weight:700>listen</span> <span style=color:#ed9d13>[::]:80</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#6ab825;font-weight:700>server_name</span> <span style=color:#ed9d13>YOUR_DOMAIN_NAME</span> <span style=color:#ed9d13>www.YOUR_DOMAIN_NAME</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#6ab825;font-weight:700>location</span> <span style=color:#ed9d13>/</span> {
</span></span><span style=display:flex><span>        <span style=color:#999;font-style:italic># Forward requests to rocket
</span></span></span><span style=display:flex><span><span style=color:#999;font-style:italic></span>        <span style=color:#6ab825;font-weight:700>proxy_pass</span> <span style=color:#ed9d13>http://127.0.0.1:8000</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6ab825;font-weight:700>server</span> {
</span></span><span style=display:flex><span>    <span style=color:#6ab825;font-weight:700>listen</span> <span style=color:#3677a9>443</span> <span style=color:#ed9d13>ssl</span> <span style=color:#ed9d13>http2</span>;
</span></span><span style=display:flex><span>    <span style=color:#6ab825;font-weight:700>listen</span> <span style=color:#ed9d13>[::]:443</span> <span style=color:#ed9d13>ssl</span> <span style=color:#ed9d13>http2</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#6ab825;font-weight:700>server_name</span> <span style=color:#ed9d13>YOUR_DOMAIN_NAME</span> <span style=color:#ed9d13>www.YOUR_DOMAIN_NAME</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#6ab825;font-weight:700>location</span> <span style=color:#ed9d13>/</span> {
</span></span><span style=display:flex><span>        <span style=color:#999;font-style:italic># Forward requests to rocket
</span></span></span><span style=display:flex><span><span style=color:#999;font-style:italic></span>        <span style=color:#6ab825;font-weight:700>proxy_pass</span> <span style=color:#ed9d13>http://127.0.0.1:8000</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><p>Then, run this command to create a symbolic link:</p><div class=highlight><div style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ln -s /etc/nginx/sites-available/YOUR_DOMAIN /etc/nginx/sites-enabled/
</span></span></code></pre></td></tr></table></div></div><p>Check your syntax with <code>nginx -t</code>.</p><p>Make sure to delete the default nginx file with <code>rm /etc/nginx/sites-available/default && rm /etc/nginx/sites-available/default</code>.</p><p>Reload nginx with <code>systemctl reload nginx</code>. Navigate to your domain on your browser with <code>http://YOUR_DOMAIN_NAME</code>. Verify that it&rsquo;s working.</p><p>If everything is working, then go ahead and setup https with <code>certbot --nginx</code> and follow the instructions. If it asks you if you want to redirect http to https, you absolutely should.</p><p>Reload nginx with <code>systemctl reload nginx</code>. Navigate to your domain on your browser with <code>https://YOUR_DOMAIN_NAME</code>. Verify that it&rsquo;s working.</p><p>I recommend setting up a cron job to auto renew your https certificates. Run <code>crontab -e</code> and insert this to run the certbot renew script at the first of each month:</p><div class=highlight><div style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-plain data-lang=plain><span style=display:flex><span>1 1 1 * * certbot renew
</span></span></code></pre></td></tr></table></div></div><h2 id=step-6-cicd-with-github-actions>Step 6: CI/CD with Github actions</h2><p>You don&rsquo;t want to have to manually log into your server, pull your latest changes, build your new binary, and restart your application whenever you push code. We can use Github Actions to automate this.</p><p>Each Github actions file is a <strong>workflow</strong>. Workflows are stored in the <code>.github/workflows</code> directory of your repository.</p><p>You will create two workflows:</p><ol><li>rust.yml (build and test)</li><li>deploy.yml (deploy)</li></ol><p>You can name them whatever you want.</p><h3 id=rustyml>rust.yml</h3><div class=highlight><div style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 1
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 2
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 3
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 4
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 5
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 6
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 7
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 8
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 9
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">10
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">11
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">12
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">13
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">14
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">15
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">16
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">17
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">18
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">19
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">20
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">21
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">22
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">23
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">24
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust.yml data-lang=rust.yml><span style=display:flex><span><span style=color:#6ab825;font-weight:700>name</span>:<span style=color:#666> </span>Rust<span style=color:#666>
</span></span></span><span style=display:flex><span><span style=color:#666>
</span></span></span><span style=display:flex><span><span style=color:#666></span><span style=color:#6ab825;font-weight:700>on</span>:<span style=color:#666>
</span></span></span><span style=display:flex><span><span style=color:#666>  </span><span style=color:#6ab825;font-weight:700>push</span>:<span style=color:#666>
</span></span></span><span style=display:flex><span><span style=color:#666>    </span><span style=color:#999;font-style:italic># change this to main if you use that</span><span style=color:#666>
</span></span></span><span style=display:flex><span><span style=color:#666>    </span><span style=color:#6ab825;font-weight:700>branches</span>:<span style=color:#666> </span>[<span style=color:#666> </span>master ]<span style=color:#666>
</span></span></span><span style=display:flex><span><span style=color:#666>  </span><span style=color:#6ab825;font-weight:700>pull_request</span>:<span style=color:#666>
</span></span></span><span style=display:flex><span><span style=color:#666>    </span><span style=color:#999;font-style:italic># change this to main if you use that</span><span style=color:#666>
</span></span></span><span style=display:flex><span><span style=color:#666>    </span><span style=color:#6ab825;font-weight:700>branches</span>:<span style=color:#666> </span>[<span style=color:#666> </span>master ]<span style=color:#666>
</span></span></span><span style=display:flex><span><span style=color:#666>
</span></span></span><span style=display:flex><span><span style=color:#666></span><span style=color:#6ab825;font-weight:700>env</span>:<span style=color:#666>
</span></span></span><span style=display:flex><span><span style=color:#666>  </span><span style=color:#6ab825;font-weight:700>CARGO_TERM_COLOR</span>:<span style=color:#666> </span>always<span style=color:#666>
</span></span></span><span style=display:flex><span><span style=color:#666>
</span></span></span><span style=display:flex><span><span style=color:#666></span><span style=color:#6ab825;font-weight:700>jobs</span>:<span style=color:#666>
</span></span></span><span style=display:flex><span><span style=color:#666>  </span><span style=color:#6ab825;font-weight:700>build</span>:<span style=color:#666>
</span></span></span><span style=display:flex><span><span style=color:#666>
</span></span></span><span style=display:flex><span><span style=color:#666>    </span><span style=color:#6ab825;font-weight:700>runs-on</span>:<span style=color:#666> </span>ubuntu-latest<span style=color:#666>
</span></span></span><span style=display:flex><span><span style=color:#666>
</span></span></span><span style=display:flex><span><span style=color:#666>    </span><span style=color:#6ab825;font-weight:700>steps</span>:<span style=color:#666>
</span></span></span><span style=display:flex><span><span style=color:#666>    </span>- <span style=color:#6ab825;font-weight:700>uses</span>:<span style=color:#666> </span>actions/checkout@v2<span style=color:#666>
</span></span></span><span style=display:flex><span><span style=color:#666>    </span>- <span style=color:#6ab825;font-weight:700>name</span>:<span style=color:#666> </span>Build<span style=color:#666>
</span></span></span><span style=display:flex><span><span style=color:#666>      </span><span style=color:#6ab825;font-weight:700>run</span>:<span style=color:#666> </span>cargo build --verbose<span style=color:#666>
</span></span></span><span style=display:flex><span><span style=color:#666>    </span>- <span style=color:#6ab825;font-weight:700>name</span>:<span style=color:#666> </span>Run tests<span style=color:#666>
</span></span></span><span style=display:flex><span><span style=color:#666>      </span><span style=color:#6ab825;font-weight:700>run</span>:<span style=color:#666> </span>cargo test --verbose<span style=color:#666>
</span></span></span></code></pre></td></tr></table></div></div><h3 id=deployyml>deploy.yml</h3><div class=highlight><div style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 1
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 2
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 3
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 4
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 5
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 6
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 7
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 8
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868"> 9
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">10
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">11
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">12
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">13
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">14
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">15
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">16
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">17
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">18
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">19
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">20
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">21
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">22
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">23
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">24
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">25
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">26
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">27
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">28
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">29
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">30
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">31
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">32
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">33
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">34
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">35
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">36
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">37
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">38
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">39
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">40
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">41
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">42
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">43
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">44
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">45
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">46
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-deploy.yml data-lang=deploy.yml><span style=display:flex><span><span style=color:#6ab825;font-weight:700>name</span>:<span style=color:#666> </span>Deploy<span style=color:#666>
</span></span></span><span style=display:flex><span><span style=color:#666>
</span></span></span><span style=display:flex><span><span style=color:#666></span><span style=color:#6ab825;font-weight:700>on</span>:<span style=color:#666>
</span></span></span><span style=display:flex><span><span style=color:#666>  </span><span style=color:#6ab825;font-weight:700>workflow_run</span>:<span style=color:#666>
</span></span></span><span style=display:flex><span><span style=color:#666>    </span><span style=color:#999;font-style:italic># Run after workflow with name &#34;Rust&#34; finishes</span><span style=color:#666>
</span></span></span><span style=display:flex><span><span style=color:#666>    </span><span style=color:#6ab825;font-weight:700>workflows</span>:<span style=color:#666> </span>[Rust]<span style=color:#666>
</span></span></span><span style=display:flex><span><span style=color:#666>    </span><span style=color:#6ab825;font-weight:700>types</span>:<span style=color:#666>
</span></span></span><span style=display:flex><span><span style=color:#666>      </span>- completed<span style=color:#666>
</span></span></span><span style=display:flex><span><span style=color:#666>
</span></span></span><span style=display:flex><span><span style=color:#666></span><span style=color:#6ab825;font-weight:700>jobs</span>:<span style=color:#666>
</span></span></span><span style=display:flex><span><span style=color:#666>  </span><span style=color:#6ab825;font-weight:700>build</span>:<span style=color:#666>
</span></span></span><span style=display:flex><span><span style=color:#666>
</span></span></span><span style=display:flex><span><span style=color:#666>    </span><span style=color:#6ab825;font-weight:700>runs-on</span>:<span style=color:#666> </span>ubuntu-latest<span style=color:#666>
</span></span></span><span style=display:flex><span><span style=color:#666>    </span><span style=color:#999;font-style:italic># only run if the build and test workflow succeeded</span><span style=color:#666>
</span></span></span><span style=display:flex><span><span style=color:#666>    </span><span style=color:#6ab825;font-weight:700>if</span>:<span style=color:#666> </span>${{ github.event.workflow_run.conclusion == &#39;success&#39; }}<span style=color:#666>
</span></span></span><span style=display:flex><span><span style=color:#666>
</span></span></span><span style=display:flex><span><span style=color:#666>    </span><span style=color:#6ab825;font-weight:700>steps</span>:<span style=color:#666>
</span></span></span><span style=display:flex><span><span style=color:#666>    </span>- <span style=color:#6ab825;font-weight:700>uses</span>:<span style=color:#666> </span>actions/checkout@v1<span style=color:#666>
</span></span></span><span style=display:flex><span><span style=color:#666>
</span></span></span><span style=display:flex><span><span style=color:#666>    </span>- <span style=color:#6ab825;font-weight:700>name</span>:<span style=color:#666> </span>Copy repository contents via scp<span style=color:#666>
</span></span></span><span style=display:flex><span><span style=color:#666>      </span><span style=color:#6ab825;font-weight:700>uses</span>:<span style=color:#666> </span>appleboy/scp-action@master<span style=color:#666>
</span></span></span><span style=display:flex><span><span style=color:#666>      </span><span style=color:#6ab825;font-weight:700>env</span>:<span style=color:#666>
</span></span></span><span style=display:flex><span><span style=color:#666>        </span><span style=color:#999;font-style:italic># see github documentation on adding secrets</span><span style=color:#666>
</span></span></span><span style=display:flex><span><span style=color:#666>        </span><span style=color:#999;font-style:italic># https://docs.github.com/en/actions/security-guides/encrypted-secrets</span><span style=color:#666>
</span></span></span><span style=display:flex><span><span style=color:#666>        </span><span style=color:#6ab825;font-weight:700>HOST</span>:<span style=color:#666> </span>${{ secrets.HOST }}<span style=color:#666>
</span></span></span><span style=display:flex><span><span style=color:#666>        </span><span style=color:#6ab825;font-weight:700>USERNAME</span>:<span style=color:#666> </span>${{ secrets.USERNAME }}<span style=color:#666>
</span></span></span><span style=display:flex><span><span style=color:#666>        </span><span style=color:#6ab825;font-weight:700>PORT</span>:<span style=color:#666> </span>${{ secrets.PORT }}<span style=color:#666>
</span></span></span><span style=display:flex><span><span style=color:#666>        </span><span style=color:#999;font-style:italic># See optional section at bottom of post to learn how to get the SSHKey</span><span style=color:#666>
</span></span></span><span style=display:flex><span><span style=color:#666>        </span><span style=color:#6ab825;font-weight:700>KEY</span>:<span style=color:#666> </span>${{ secrets.SSHKEY }}<span style=color:#666>
</span></span></span><span style=display:flex><span><span style=color:#666>      </span><span style=color:#6ab825;font-weight:700>with</span>:<span style=color:#666>
</span></span></span><span style=display:flex><span><span style=color:#666>        </span><span style=color:#6ab825;font-weight:700>source</span>:<span style=color:#666> </span><span style=color:#ed9d13>&#34;.&#34;</span><span style=color:#666>
</span></span></span><span style=display:flex><span><span style=color:#666>        </span><span style=color:#6ab825;font-weight:700>target</span>:<span style=color:#666> </span><span style=color:#ed9d13>&#34;/path/to/your/project&#34;</span><span style=color:#666>
</span></span></span><span style=display:flex><span><span style=color:#666>
</span></span></span><span style=display:flex><span><span style=color:#666>    </span>- <span style=color:#6ab825;font-weight:700>name</span>:<span style=color:#666> </span>Executing remote command<span style=color:#666>
</span></span></span><span style=display:flex><span><span style=color:#666>      </span><span style=color:#6ab825;font-weight:700>uses</span>:<span style=color:#666> </span>appleboy/ssh-action@master<span style=color:#666>
</span></span></span><span style=display:flex><span><span style=color:#666>      </span><span style=color:#6ab825;font-weight:700>with</span>:<span style=color:#666>
</span></span></span><span style=display:flex><span><span style=color:#666>        </span><span style=color:#6ab825;font-weight:700>host</span>:<span style=color:#666> </span>${{ secrets.HOST }}<span style=color:#666>
</span></span></span><span style=display:flex><span><span style=color:#666>        </span><span style=color:#6ab825;font-weight:700>USERNAME</span>:<span style=color:#666> </span>${{ secrets.USERNAME }}<span style=color:#666>
</span></span></span><span style=display:flex><span><span style=color:#666>        </span><span style=color:#6ab825;font-weight:700>PORT</span>:<span style=color:#666> </span>${{ secrets.PORT }}<span style=color:#666>
</span></span></span><span style=display:flex><span><span style=color:#666>        </span><span style=color:#6ab825;font-weight:700>KEY</span>:<span style=color:#666> </span>${{ secrets.SSHKEY }}<span style=color:#666>
</span></span></span><span style=display:flex><span><span style=color:#666>        </span><span style=color:#6ab825;font-weight:700>command_timeout</span>:<span style=color:#666> </span>30m<span style=color:#666>
</span></span></span><span style=display:flex><span><span style=color:#666>        </span><span style=color:#6ab825;font-weight:700>script_stop</span>:<span style=color:#666> </span><span style=color:#6ab825;font-weight:700>true</span><span style=color:#666>
</span></span></span><span style=display:flex><span><span style=color:#666>        </span><span style=color:#6ab825;font-weight:700>script</span>:<span style=color:#666> </span>|<span style=color:#ed9d13>
</span></span></span><span style=display:flex><span><span style=color:#ed9d13>             cd /path/to/your/project
</span></span></span><span style=display:flex><span><span style=color:#ed9d13>             /root/.cargo/bin/cargo build --release
</span></span></span><span style=display:flex><span><span style=color:#ed9d13>             systemctl restart YOUR_DOMAIN.service</span><span style=color:#666>             
</span></span></span></code></pre></td></tr></table></div></div><h2 id=optional-safer-and-easier-sshing-into-your-vps>Optional: Safer and Easier SSHing into your VPS</h2><p>I like sshing with RSA keys because you don&rsquo;t have to enter a password. If you don&rsquo;t already have a keypair, run the following commands on your host machine (the machine you ssh from)</p><div class=highlight><div style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">1
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">2
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ssh-keygen
</span></span><span style=display:flex><span>ssh-copy-id USER@VPS_IP_ADDR
</span></span></code></pre></td></tr></table></div></div><p>Use all of the defaults and don&rsquo;t add a password to your key, unless you want to have to type your password to use it. I&rsquo;m not super concerned about putting a password on my key because I&rsquo;ll have bigger things to worry about if someone ever got my key to begin with.</p><p>Verify that you can ssh into your machine without a password by running <code>ssh USER@VPS_IP_ADDR</code>.</p><p>You can create an ssh profile by editing ~/.ssh/config on your host machine like so:</p><div class=highlight><div style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">1
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">2
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">3
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">4
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-plain data-lang=plain><span style=display:flex><span>Host PROFILE_NAME
</span></span><span style=display:flex><span>    HostName VPS_IP_ADDR
</span></span><span style=display:flex><span>    User USER
</span></span><span style=display:flex><span>    IdentityFile ~/.ssh/id_rsa
</span></span></code></pre></td></tr></table></div></div><p>which will allow you to ssh into your VPS by running <code>ssh PROFILE_NAME</code>.</p><p>I also like to disable text passwords to my remote machines so that only I can access them (or anyone with a key). If you also want to do this, set the following options in <code>etc/ssh/sshd_config</code>:</p><div class=highlight><div style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">1
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">2
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">3
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#686868">4
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-plain data-lang=plain><span style=display:flex><span>/etc/ssh/sshd_config
</span></span><span style=display:flex><span>PassWordAuthentication no
</span></span><span style=display:flex><span>UsePam no
</span></span><span style=display:flex><span>ChallengeResponseAuthentication no
</span></span></code></pre></td></tr></table></div></div></article></div><div class="meta article-card"><div class=row><span class=label><svg xmlns="http://www.w3.org/2000/svg" class="ionicon" viewBox="0 0 512 512"><path d="M32 456a24 24 0 0024 24h4e2a24 24 0 0024-24V176H32zm320-244a4 4 0 014-4h40a4 4 0 014 4v40a4 4 0 01-4 4h-40a4 4 0 01-4-4zm0 80a4 4 0 014-4h40a4 4 0 014 4v40a4 4 0 01-4 4h-40a4 4 0 01-4-4zm-80-80a4 4 0 014-4h40a4 4 0 014 4v40a4 4 0 01-4 4h-40a4 4 0 01-4-4zm0 80a4 4 0 014-4h40a4 4 0 014 4v40a4 4 0 01-4 4h-40a4 4 0 01-4-4zm0 80a4 4 0 014-4h40a4 4 0 014 4v40a4 4 0 01-4 4h-40a4 4 0 01-4-4zm-80-80a4 4 0 014-4h40a4 4 0 014 4v40a4 4 0 01-4 4h-40a4 4 0 01-4-4zm0 80a4 4 0 014-4h40a4 4 0 014 4v40a4 4 0 01-4 4h-40a4 4 0 01-4-4zm-80-80a4 4 0 014-4h40a4 4 0 014 4v40a4 4 0 01-4 4h-40a4 4 0 01-4-4zm0 80a4 4 0 014-4h40a4 4 0 014 4v40a4 4 0 01-4 4h-40a4 4 0 01-4-4zM456 64h-55.92V32h-48v32H159.92V32h-48v32H56A23.8 23.8.0 0032 87.77V144h448V87.77A23.8 23.8.0 00456 64z"/></svg>Published At</span><time>2020-08-15 00:00 UTC</time></div><div class=row><span class=label><svg xmlns="http://www.w3.org/2000/svg" class="ionicon" viewBox="0 0 512 512"><path d="M288 16 0 304l176 176 288-288V16zm80 128a32 32 0 1132-32 32 32 0 01-32 32z"/><path d="M480 64v144L216.9 471.1 242 496l270-272V64h-32z"/></svg>Tagged with</span><ul class=tags><li class=hashed-tag><a href=/tags/rocket>rocket</a></li><li class=hashed-tag><a href=/tags/rust>rust</a></li><li class=hashed-tag><a href=/tags/vps>vps</a></li><li class=hashed-tag><a href=/tags/nginx>nginx</a></li><li class=hashed-tag><a href=/tags/linux>linux</a></li><li class=hashed-tag><a href=/tags/ssh>ssh</a></li><li class=hashed-tag><a href=/tags/github-actions>github-actions</a></li><li class=hashed-tag><a href=/tags/web-dev>web-dev</a></li></ul></div><div class="row social-share"><span class=label><svg xmlns="http://www.w3.org/2000/svg" class="ionicon" viewBox="0 0 512 512"><path d="M272 176v161h-32V176H92a12 12 0 00-12 12v280a12 12 0 0012 12h328a12 12 0 0012-12V188a12 12 0 00-12-12zm0-83.37 64 64L358.63 134 256 31.37 153.37 134 176 156.63l64-64V176h32V92.63z"/></svg>Share with</span>
<a target=_blank title="share to reddit" rel="noopener noreferrer" aria-label="share How to Deploy a Rocket Rust Web Application on VPS on reddit" href="https://reddit.com/submit?url=%2fposts%2fhow-to-deploy-rocket-rust-web-app-on-vps%2f&title=How%20to%20Deploy%20a%20Rocket%20Rust%20Web%20Application%20on%20VPS"><svg xmlns="http://www.w3.org/2000/svg" class="ionicon" viewBox="0 0 512 512" fill="currentcolor" stroke="currentcolor" stroke-width="10"><path d="M324 256a36 36 0 1036 36 36 36 0 00-36-36z"/><circle cx="188" cy="292" r="36" transform="rotate(-22.5 187.997 291.992)"/><path d="M496 253.77c0-31.19-25.14-56.56-56-56.56a55.72 55.72.0 00-35.61 12.86c-35-23.77-80.78-38.32-129.65-41.27l22-79 66.41 13.2c1.9 26.48 24 47.49 50.65 47.49 28 0 50.78-23 50.78-51.21S441 48 413 48c-19.53.0-36.31 11.19-44.85 28.77l-90-17.89-31.1 109.52-4.63.13c-50.63 2.21-98.34 16.93-134.77 41.53A55.38 55.38.0 0072 197.21c-30.89.0-56 25.37-56 56.56a56.43 56.43.0 0028.11 49.06 98.65 98.65.0 00-.89 13.34c.11 39.74 22.49 77 63 105C146.36 448.77 199.51 464 256 464s109.76-15.23 149.83-42.89c40.53-28 62.85-65.27 62.85-105.06a109.32 109.32.0 00-.84-13.3A56.32 56.32.0 00496 253.77zM414 75a24 24 0 11-24 24 24 24 0 0124-24zM42.72 253.77a29.6 29.6.0 0129.42-29.71 29 29 0 0113.62 3.43c-15.5 14.41-26.93 30.41-34.07 47.68a30.23 30.23.0 01-8.97-21.4zM390.82 399c-35.74 24.59-83.6 38.14-134.77 38.14S157 423.61 121.29 399c-33-22.79-51.24-52.26-51.24-83A78.5 78.5.0 0175 288.72c5.68-15.74 16.16-30.48 31.15-43.79a155.17 155.17.0 0114.76-11.53l.3-.21.24-.17c35.72-24.52 83.52-38 134.61-38s98.9 13.51 134.62 38l.23.17.34.25A156.57 156.57.0 01406 244.92c15 13.32 25.48 28.05 31.16 43.81a85.44 85.44.0 014.31 17.67 77.29 77.29.0 01.6 9.65c-.01 30.72-18.21 60.19-51.25 82.95zm69.6-123.92c-7.13-17.28-18.56-33.29-34.07-47.72A29.09 29.09.0 01440 224a29.59 29.59.0 0129.41 29.71 30.07 30.07.0 01-8.99 21.39z"/><path d="M323.23 362.22c-.25.25-25.56 26.07-67.15 26.27-42-.2-66.28-25.23-67.31-26.27a4.14 4.14.0 00-5.83.0l-13.7 13.47a4.15 4.15.0 000 5.89c3.4 3.4 34.7 34.23 86.78 34.45 51.94-.22 83.38-31.05 86.78-34.45a4.16 4.16.0 000-5.9l-13.71-13.47a4.13 4.13.0 00-5.81.0z"/></svg></a><a target=_blank title="share to twitter" rel="noopener noreferrer" aria-label="share How to Deploy a Rocket Rust Web Application on VPS on twitter" href="https://twitter.com/intent/tweet/?text=How%20to%20Deploy%20a%20Rocket%20Rust%20Web%20Application%20on%20VPS&url=%2fposts%2fhow-to-deploy-rocket-rust-web-app-on-vps%2f&hashtags=rocket%2crust%2cvps%2cnginx%2clinux%2cssh%2cgithub-actions%2cweb-dev"><svg class="ionicon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" style="fill:none" stroke="currentcolor" stroke-width="2"><path d="M23 3a10.9 10.9.0 01-3.14 1.53 4.48 4.48.0 00-7.86 3v1A10.66 10.66.0 013 4s-4 9 5 13a11.64 11.64.0 01-7 2c9 5 20 0 20-11.5a4.5 4.5.0 00-.08-.83A7.72 7.72.0 0023 3z"/></svg></a><a target=_blank title="share to facebook" rel="noopener noreferrer" aria-label="share How to Deploy a Rocket Rust Web Application on VPS on facebook" href="https://facebook.com/sharer/sharer.php?u=%2fposts%2fhow-to-deploy-rocket-rust-web-app-on-vps%2f"><svg xmlns="http://www.w3.org/2000/svg" class="ionicon" viewBox="0 0 24 24" style="fill:none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-facebook"><path d="M18 2h-3a5 5 0 00-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 011-1h3z"/></svg></a></div></div><div id=comments class=article-card><script src=https://utteranc.es/client.js repo=jrodal98/website issue-term=url theme=preferred-color-scheme crossorigin=anonymous async></script></div></div></main><footer id=footer><div class="container has-padding is-flex"><ul class=links><li><a rel=nofollow target=_blank href=https://github.com/jrodal98 title=Github>Github</a></li><li><a rel=nofollow target=_blank href=https://www.linkedin.com/in/jacob-rodal title=LinkedIn>LinkedIn</a></li><li><a class="nav-link navbar-button" href=/index.xml type=application/rss+xml>RSS</a></li><li><a rel=nofollow target=_blank href=https://github.com/jrodal98/website title="Source Code">Source Code</a></li></ul><div class=copyright>&copy; 2022 Jacob Rodal</div></div></footer><script>window.FluencyCopyIcon="\n\n\n\n\n\n\n\u003csvg xmlns=\u0027http://www.w3.org/2000/svg\u0027 class=\u0027ionicon\u0027 viewBox=\u00270 0 512 512\u0027\u003e\u003crect x=\u0027128\u0027 y=\u0027128\u0027 width=\u0027336\u0027 height=\u0027336\u0027 rx=\u002757\u0027 ry=\u002757\u0027 stroke-linejoin=\u0027round\u0027 class=\u0027ionicon-fill-none ionicon-stroke-width\u0027/\u003e\u003cpath d=\u0027M383.5 128l.5-24a56.16 56.16 0 00-56-56H112a64.19 64.19 0 00-64 64v216a56.16 56.16 0 0056 56h24\u0027 stroke-linecap=\u0027round\u0027 stroke-linejoin=\u0027round\u0027 class=\u0027ionicon-fill-none ionicon-stroke-width\u0027/\u003e\u003c/svg\u003e\n\n\n\n\n\n\n\n\n\n\n"</script><script defer src=/js/main.min.8a03b7cd665b1352a56537802c91976fc70104f52f2771933bd6ea7a1cce4560.js integrity="sha256-igO3zWZbE1KlZTeALJGXb8cBBPUvJ3GTO9bqehzORWA=" crossorigin=anonymous async></script><noscript><style type=text/css>#theme-selector-button{display:none}</style></noscript></body></html>